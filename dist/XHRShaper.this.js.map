{"version":3,"sources":["webpack:///webpack/bootstrap 1389f34958d50b4408fb","webpack:///./src/xhr.js","webpack:///./src/throttled-xhr.js","webpack:///./index.js","webpack:///./src/setup-throttled-xhr.js","webpack:///./src/shaper.js"],"names":["XMLHttpRequest","window","XHRProxy","_xhr","abort","method","url","async","user","password","open","data","send","header","value","setRequestHeader","getResponseHeader","mimeType","overrideMimeType","getAllResponseHeaders","type","listener","optionsOrUseCapture","wantsUntrusted","addEventListener","removeEventListener","event","dispatchEvent","readyState","response","responseText","responseXML","responseURL","status","statusText","upload","enabled","withCredentials","responseType","timeout","fn","onload","onloadstart","onloadend","onabort","onerror","onprogress","ontimeout","onreadystatechange","PASSTHROUGH_EVENTS","createListenerWrapper","dispatchedEventsList","push","propagated","ThrottledXHR","_shaper","_listenersMap","Map","_dispatchedEventsList","setTimeout","filter","dispatchedEvent","forEach","includes","listenerWrapper","set","get","delete","_onloadend","_onload","_onreadystatechange","_onprogress","useGlobal","global","module","exports","setupThrottledXhr","xhr","xhrProxy","shaper","openedTs","headersTs","loadingTs","doneTs","loaded","total","currentBitrateKpbs","progressEvents","progressTimer","lastProgressEvent","loadEndEvent","loadEvent","done","_dispatchWrappedEventType","triggerStateChange","e","Date","now","delay1","delay2","latency","minLatency","maxBandwidth","clearTimeout","length","Math","max","triggerProgress","duration","delay","id","round","random","__throttledId","Shaper","_maxBandwidth","Infinity","_minLatency","_minProgressEvents","_randomness","Object","defineProperty","min","val","minProgressEvents","randomness"],"mappings":"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","file":"XHRShaper.this.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1389f34958d50b4408fb","// See https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n\nconst XMLHttpRequest = window.XMLHttpRequest;\n\nclass XHRProxy {\n\n    constructor() {\n        this._xhr = new XMLHttpRequest();\n    }\n\n    // methods\n\n    abort() {\n        return this._xhr.abort();\n    }\n    open(method, url, async, user, password) {\n        return this._xhr.open(method, url, async, user, password); \n    }\n    send(data) {\n        return this._xhr.send(data);   \n    }\n    setRequestHeader(header, value) {\n        return this._xhr.setRequestHeader(header, value);\n    }\n    getResponseHeader(header) {\n        return this._xhr.getResponseHeader(header);\n    }\n    overrideMimeType(mimeType) {\n        return this._xhr.overrideMimeType(mimeType);\n    }\n    getAllResponseHeaders() {\n        return this._xhr.getAllResponseHeaders();\n    }\n\n    addEventListener(type, listener, optionsOrUseCapture, wantsUntrusted) {\n        return this._xhr.addEventListener(type, listener, optionsOrUseCapture, wantsUntrusted);\n    }\n    removeEventListener(type, listener, optionsOrUseCapture) {\n        return this._xhr.removeEventListener(type, listener, optionsOrUseCapture);\n    }\n    dispatchEvent(event) {\n        return this._xhr.dispatchEvent(event);\n    }\n\n    // Read-only properties\n\n    get readyState() {\n        return this._xhr.readyState;\n    }\n    get response() {\n        return this._xhr.response;\n    }\n    get responseText() {\n        return this._xhr.responseText;   \n    }\n    get responseXML() {\n        return this._xhr.responseXML;\n    }\n    get responseURL() {\n        return this._xhr.responseURL;\n    }\n    get status() {\n        return this._xhr.status;\n    }\n    get statusText() {\n        return this._xhr.statusText;\n    }\n    get upload() {\n        return this._xhr.upload;\n    }\n    \n    // R & W properties\n\n    set withCredentials(enabled) {\n        this._xhr.withCredentials = enabled;\n    }\n    get withCredentials() {\n        return this._xhr.withCredentials;\n    }\n\n    set responseType(responseType) {\n        this._xhr.responseType = responseType;\n    }\n    get responseType() {\n        return this._xhr.responseType;\n    }\n\n    set timeout(timeout) {\n        this._xhr.timeout = timeout;\n    }\n    get timeout() {\n        return this._xhr.timeout;\n    }\n\n    set onload(fn) {\n        this._xhr.onload = fn;\n    }\n    get onload() {\n        return this._xhr.onload;\n    }\n\n    set onloadstart(fn) {\n        this._xhr.onloadstart = fn;\n    }\n    get onloadstart() {\n        return this._xhr.onloadstart;\n    }    \n\n    set onloadend(fn) {\n        this._xhr.onloadend = fn;\n    }\n    get onloadend() {\n        return this._xhr.onloadend;\n    }\n\n    set onabort(fn) {\n        this._xhr.onabort = fn;\n    }\n    get onabort() {\n        return this._xhr.onabort;\n    }\n\n    set onerror(fn) {\n        this._xhr.onerror = fn;\n    }\n    get onerror() {\n        return this._xhr.onerror;\n    }\n\n    set onprogress(fn) {\n        this._xhr.onprogress = fn;\n    }\n    get onprogress() {\n        return this._xhr.onprogress;\n    }\n\n    set ontimeout(fn) {\n        this._xhr.ontimeout = fn;\n    }\n    get ontimeout() {\n        return this._xhr.ontimeout;\n    }\n\n    set onreadystatechange(fn) {\n        this._xhr.onreadystatechange = fn;\n    }\n    get onreadystatechange() {\n        return this._xhr.onreadystatechange;\n    } \n}\n\nexport default XHRProxy;\n\n\n// WEBPACK FOOTER //\n// ./src/xhr.js","import XHRProxy from './xhr';\nimport Shaper from './shaper';\nimport setupThrottledXhr from './setup-throttled-xhr';\n\nconst PASSTHROUGH_EVENTS = ['loadstart', 'timeout', 'abort', 'error'];\n\nconst createListenerWrapper = (type, listener, dispatchedEventsList) => {\n    return (event) => {\n        dispatchedEventsList.push({type, listener, event, propagated: false});\n    };\n}\n\nclass ThrottledXHR extends XHRProxy {\n\n    static get Shaper() {\n        return Shaper;\n    }\n\n    constructor() {\n        super();\n        this._shaper = new Shaper();\n        this._listenersMap = new Map();\n        this._dispatchedEventsList = [];\n\n        setupThrottledXhr(this._xhr, this);\n    }\n\n    _dispatchWrappedEventType(type) {\n        // it needs to run on the next tick since this is actually\n        // triggered from our throttler listeners on the proxy's inner XHR \n        setTimeout(() => {\n            this._dispatchedEventsList\n                .filter((dispatchedEvent) => (dispatchedEvent.type === type && !dispatchedEvent.propagated))\n                .forEach((dispatchedEvent) => {\n                    dispatchedEvent.propagated = true;\n                    dispatchedEvent.listener(dispatchedEvent.event);\n                });            \n        }, 0);\n    }\n\n    addEventListener(type, listener, optionsOrUseCapture, wantsUntrusted) {\n\n        if (PASSTHROUGH_EVENTS.includes(type)) {\n            return super.addEventListener(type, listener, optionsOrUseCapture, wantsUntrusted);\n        }\n\n        const listenerWrapper = createListenerWrapper(type, listener, this._dispatchedEventsList);\n        this._listenersMap.set(listener, listenerWrapper);\n        return super.addEventListener(type, listenerWrapper, optionsOrUseCapture, wantsUntrusted);\n    }\n    removeEventListener(type, listener, optionsOrUseCapture) {\n\n        if (PASSTHROUGH_EVENTS.includes(type)) {\n            return super.removeEventListener(type, listener, optionsOrUseCapture)\n        }\n\n        const listenerWrapper = this._listenersMap.get(listener);\n        if (!listenerWrapper) {\n            return;\n        }\n        this._listenersMap.delete(listener);\n        return super.removeEventListener(type, listenerWrapper, optionsOrUseCapture);\n    }\n    dispatchEvent(event) {\n        return super.dispatchEvent(event);\n    }\n\n    get shaper() {\n        return this._shaper;\n    }\n\n    set onloadend(fn) {\n        this._onloadend = fn;\n    }\n\n    get onloadend() {\n        return this._onloadend;\n    }\n\n    set onload(fn) {\n        this._onload = fn;\n    }\n\n    get onload() {\n        return this._onload;\n    }\n\n    set onreadystatechange(fn) {\n        this._onreadystatechange = fn;\n    }\n\n    get onreadystatechange() {\n        return this._onreadystatechange;\n    }\n\n    set onprogress(fn) {\n        this._onprogress = fn;\n    }\n\n    get onprogress() {\n        return this._onprogress;\n    }\n}\n\nexport default ThrottledXHR;\n\n\n// WEBPACK FOOTER //\n// ./src/throttled-xhr.js","import XHRProxy from './src/xhr';\nimport ThrottledXHR from './src/throttled-xhr';\n\nfunction useGlobal() {\n    // Shim window/global XHR\n    var global = window || global;\n    // Overload native window constructor\n    global.XMLHttpRequest = ThrottledXHR;\n}\n\nmodule.exports = {\n    XMLHttpRequest: ThrottledXHR,\n    ThrottledXHR,\n    XHRProxy,\n    useGlobal\n};\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","function setupThrottledXhr(xhr, xhrProxy) {\n\n    let {\n        shaper\n    } = xhrProxy;\n\n    let openedTs, headersTs, loadingTs, doneTs;\n    let loaded = 0, total;\n    let currentBitrateKpbs;\n    let progressEvents = [];\n    let progressTimer;\n    let lastProgressEvent = false;\n    let loadEndEvent;\n    let loadEvent;\n    let done = false;\n\n    xhr.onloadend = function(event) {\n\n        let {\n            _onloadend\n        } = xhrProxy;\n\n        //console.log('native loadend');\n        loadEndEvent = event;\n        if (done) {\n            _onloadend && _onloadend(event);\n            xhrProxy._dispatchWrappedEventType('loadend');\n        }\n    };\n\n    xhr.onload = function(event) {\n\n        let {\n            _onload \n        } = xhrProxy;\n\n        //console.log('native load');\n        loadEvent = event;\n        if (done && xhr.readyState === 4) {\n            _onload && _onload(event);\n            xhrProxy._dispatchWrappedEventType('load');\n        }\n    };\n\n    xhr.onreadystatechange = function(event) {\n\n        let {\n            _onreadystatechange,\n            _onprogress,\n            _onload,\n            _onloadend\n        } = xhrProxy;\n\n        function triggerStateChange(e) {\n            _onreadystatechange && _onreadystatechange(e);\n            xhrProxy._dispatchWrappedEventType('readystatechange');\n        }\n\n        switch (xhr.readyState) {\n            case 0: // UNSENT\n                triggerStateChange(event);\n                break;\n            case 1: // OPENED\n                openedTs = Date.now();\n                triggerStateChange(event);\n                break;\n            case 2: // HEADERS_RECEIVE\n                headersTs = Date.now();\n                triggerStateChange(event);\n                break;\n            case 3: // LOADING\n                loadingTs = Date.now();\n                triggerStateChange(event);\n                break;\n            case 4: // DONE\n                let delay1 = 0, delay2 = 0;\n                doneTs = Date.now();\n                let latency = doneTs - openedTs;\n                if (latency < shaper.minLatency) {\n                    delay1 = shaper.minLatency - latency;\n                }\n                if (currentBitrateKpbs > shaper.maxBandwidth) {\n                    delay2 = (currentBitrateKpbs / shaper.maxBandwidth) * latency - latency;\n                }\n                if (delay1 || delay2) {\n                    setTimeout(function() {\n\n                        if (loaded === total && !lastProgressEvent) {\n                            clearTimeout(progressTimer);\n                            _onprogress && _onprogress(progressEvents[progressEvents.length - 1]);\n                            xhrProxy._dispatchWrappedEventType('progress');\n                        }\n\n                        triggerStateChange(event);\n\n                        done = true;\n\n                        if (loadEvent) {\n                            _onload && _onload(loadEvent);\n                            xhrProxy._dispatchWrappedEventType('load');\n                            loadEvent = null;\n                        }\n\n                        if (loadEndEvent) {\n                            _onloadend && _onloadend(loadEndEvent);\n                            xhrProxy._dispatchWrappedEventType('loadend');\n                            loadEndEvent = null;\n                        }\n\n                    }, Math.max(delay1, delay2));\n                } else {\n                    //console.log('done, not delaying');\n                    done = true;\n                    triggerStateChange(event);\n                }\n                break;\n        }\n    };\n\n    xhr.onprogress = function(event) {\n\n        let {\n            _onprogress\n        } = xhrProxy;\n\n        function triggerProgress(e) {\n\n            if (loaded === total) {\n                lastProgressEvent = true;\n            }\n\n            _onprogress && _onprogress(e);\n            xhrProxy._dispatchWrappedEventType('progress');\n        }\n\n        let now = Date.now();\n        let duration = now - openedTs;\n        let delay;\n\n        loaded = event.loaded;\n        total = event.total;\n        currentBitrateKpbs = 8 * loaded / duration; // kbps\n\n        // console.log('current bitrate: ' + Math.round(currentBitrateKpbs) + ' kbps');\n\n        if (currentBitrateKpbs > shaper.maxBandwidth) {\n            delay = (currentBitrateKpbs / shaper.maxBandwidth) * duration - duration;\n            progressEvents.push(event);\n            // console.log('delaying progress event by ' + Math.round(delay) + ' ms');\n            progressTimer = setTimeout(function() {\n                triggerProgress(event);\n            }, delay);\n            return;\n        }\n\n        triggerProgress(event);\n    };\n\n    let id = Math.round(Math.random() * 1e6);\n\n    xhr.__throttledId = id;\n    xhrProxy.__throttledId = id;\n}\n\nexport default setupThrottledXhr;\n\n\n// WEBPACK FOOTER //\n// ./src/setup-throttled-xhr.js","var Shaper = function() {\n    var _maxBandwidth = Infinity;\n    var _minLatency = 0;\n    var _minProgressEvents = 0;\n    var _randomness = 0;\n\n    Object.defineProperty(this, \"maxBandwidth\", {\n        get: function() {\n            return Math.min(_maxBandwidth, Shaper.maxBandwidth);\n        },\n        set: function(val) { _maxBandwidth = val; }\n    });\n    Object.defineProperty(this, \"minLatency\", {\n        get: function() {\n            return Math.max(_minLatency, Shaper.minLatency);\n        },\n        set: function(val) { _minLatency = val; }\n    });\n    Object.defineProperty(this, \"minProgressEvents\", {\n        get: function() {\n            return Math.max(_minProgressEvents, Shaper.minProgressEvents);\n        },\n        set: function(val) { _minProgressEvents = val; }\n    });\n    Object.defineProperty(this, \"randomness\", {\n        get: function() {\n            return Math.max(_randomness, Shaper.randomness);\n        },\n        set: function(val) { _randomness = val; }\n    });\n};\n\nShaper.maxBandwidth = Infinity;\nShaper.minLatency = 0;\nShaper.minProgressEvents = 0;\nShaper.randomness = 0;\n\nmodule.exports = Shaper;\n\n\n// WEBPACK FOOTER //\n// ./src/shaper.js"],"sourceRoot":""}